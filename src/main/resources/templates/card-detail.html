<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<head>
    <meta charset="utf-8">
    <title>预订运营平台 - 卡详情</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" th:href="@{/static/lib/layui-v2.5.4/css/layui.css}" media="all">
    <link rel="stylesheet" th:href="@{/static/css/public.css}" media="all">
</head>
<body class="layui-dialog-body">
<form class="layui-form layui-form-pane" action="" lay-filter="formdata">
    <div class="layui-row layui-col-space5">
        <div class="layui-col-xs6 layui-col-sm6 layui-col-md6">
            <div class="layui-form-item">
                <label class="layui-form-label">卡号</label>
                <div class="layui-input-block">
                    <input type="text" name="cardCode" autocomplete="off" disabled class="layui-input"
                           value="">
                </div>
            </div>
        </div>
        <div class="layui-col-xs6 layui-col-sm6 layui-col-md6">
            <div class="layui-form-item">
                <label class="layui-form-label">批次号</label>
                <div class="layui-input-block">
                    <input type="text" name="cardBatchno" autocomplete="off" disabled class="layui-input"
                           value="">
                </div>
            </div>
        </div>
    </div>
    <div class="layui-row layui-col-space5">
        <div class="layui-col-xs6 layui-col-sm6 layui-col-md6">
            <div class="layui-form-item">
                <label class="layui-form-label">卡名称</label>
                <div class="layui-input-block">
                    <input type="text" name="cardName" autocomplete="off" disabled class="layui-input">
                </div>
            </div>
        </div>
        <div class="layui-col-xs6 layui-col-sm6 layui-col-md6">
            <div class="layui-form-item">
                <label class="layui-form-label">销售价格</label>
                <div class="layui-input-block">
                    <input type="text" name="cardSaleprice" disabled autocomplete="off" class="layui-input">
                </div>
            </div>
        </div>
    </div>
    <div class="layui-row layui-col-space5">
        <div class="layui-col-xs6 layui-col-sm6 layui-col-md6">
            <div class="layui-form-item">
                <label class="layui-form-label">卡面值</label>
                <div class="layui-input-block">
                    <input type="text" name="cardFaceprice" disabled autocomplete="off" class="layui-input">
                </div>
            </div>
        </div>
        <div class="layui-col-xs6 layui-col-sm6 layui-col-md6">
            <div class="layui-form-item">
                <label class="layui-form-label">兑换码</label>
                <div class="layui-input-block">
                    <input type="text" name="cardConvertcode" disabled autocomplete="off" class="layui-input">
                </div>
            </div>
        </div>
    </div>
    <div class="layui-row layui-col-space5">
        <div class="layui-col-xs6 layui-col-sm6 layui-col-md6">
            <div class="layui-form-item">
                <label class="layui-form-label">过期时间</label>
                <div class="layui-input-block">
                    <input type="text" name="cardExpireddate" class="layui-input" disabled>
                </div>
            </div>
        </div>
        <div class="layui-col-xs6 layui-col-sm6 layui-col-md6">
            <div class="layui-form-item">
                <label class="layui-form-label">兑换状态</label>
                <div class="layui-input-block">
                    <input type="text" name="cardConvertstate" disabled autocomplete="off" class="layui-input">
                </div>
            </div>
        </div>
    </div>
    <div class="layui-row">
        <div class="layui-col-xs12 layui-col-sm12 layui-col-md12">
            <div class="layui-form-item layui-form-text">
                <label class="layui-form-label">备注</label>
                <div class="layui-input-block">
                    <textarea name="cardRemark" disabled class="layui-textarea"></textarea>
                </div>
            </div>
        </div>
    </div>
    <div class="layui-row">
        <fieldset class="layui-elem-field layuimini-search">
            <legend>商品列表</legend>
            <div class="layui-margin-10">
                <div id="goodList" class="layui-row layui-col-space5">
                </div>
            </div>
        </fieldset>
    </div>
</form>
<script th:src="@{/static/lib/jquery-3.4.1/jquery-3.4.1.min.js}" charset="utf-8"></script>
<script th:src="@{/static/lib/layui-v2.5.4/layui.js}" charset="utf-8"></script>
<script th:src="@{/static/js/lay-config.js?v=1.0.4}" charset="utf-8"></script>
<script th:src="@{/static/js/public.js}" charset="utf-8"></script>
<script>
    //显示数据
    function renderData(data) {
        layui.use(['form'], function () {
            var form = layui.form;

            form.val("formdata", {
                "cardId": data.cardId,
                "cardCode": data.cardCode,
                "cardBatchno": data.cardBatchno,
                "cardName": data.cardName,
                "cardSaleprice": data.cardSaleprice,
                "cardFaceprice": data.cardFaceprice,
                "cardExpireddate": formatDate(data.cardExpireddate),
                "cardConvertcode": data.cardConvertcode,
                "cardConvertstate": data.cardConvertstate,
                "cardRemark": data.cardRemark
            });

            //获取卡商品
            $.ajax({
                url: "manager/getCardDetail",
                dataType: "json",
                type: "get",
                data: {"code": data.cardConvertcode},
                success: function (result) {
                    if(result.code == 200){
                        var data = result.data;
                        var str = '';
                        for(var i = 0; i < data.length; i++){
                            var card = data[i];
                            str += '<div class="layui-col-xs4 layui-col-sm4 layui-col-md4 text-center"><dt>';
                            str += '<dd>' + card.proName + '</dd>';
                            str += '<dd><img src="' + card.proCover + '" width="90%"/> </dd>';
                            if(card.cpIsmain == 1){
                                str += '<dd><input type="radio" name="mainProduct" title="主推" checked="" disabled> </dd>';
                            }
                            str += '</dt></div>';
                        }
                        $("#goodList").html(str);
                        form.render("radio");
                    }
                }
            });
        });
    }
</script>
</body>
</html>